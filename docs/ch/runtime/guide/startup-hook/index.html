

<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="description" content="Description">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <!-- <script defer src="https://use.fontawesome.com/releases/v5.0.8/js/all.js"></script> -->
    <link rel="stylesheet" href="https://unpkg.com/docsify/lib/themes/vue.css">
    <link rel="stylesheet" href="https://unpkg.com/docsify-copy-code/styles.css">
    <link rel=“prefetch” href="https://fonts.googleapis.com/css?family=Roboto:400,500">
    <link rel="stylesheet" href="/assets/css/normalize.css">
    <link rel="stylesheet" href="/assets/css/styles.css">
    <link rel="stylesheet" href="/assets/css/bundle.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.css" />
    <link rel="stylesheet" href="//unpkg.com/gitalk/dist/gitalk.css">
</head>

<body class="ready sticky">

    <template id="sidebar2-template">
    <div class="sidebar_2_wrapper">
        <div class="sidebar_2">
            <a href="/runtime/overview" data-page="runtime-page">
                <div class="sidebar_2_item sidebar_2_item_runtime">
                    <img class="sidebar_2_item__image" src="/assets/static/pm2-logo-r.png">
                    <div class="sidebar_2_item__text">Runtime</div>
                </div>
            </a>
            <a href="/monitoring/overview" data-page="monitoring-page">
                <div class="sidebar_2_item sidebar_2_item_monitoring">
                    <img class="sidebar_2_item__image" src="/assets/static/pm2-logo-m.png">
                    <div class="sidebar_2_item__text">Monitoring</div>
                </div>
            </a>
            <a href="/enterprise/overview" data-page="enterprise-page">
                <div class="sidebar_2_item sidebar_2_item_enterprise">
                    <img class="sidebar_2_item__image" src="/assets/static/pm2-logo-e.png">
                    <div class="sidebar_2_item__text">Enterprise</div>
                </div>
            </a>
        </div>
        <div class="main_content">
        </div>
    </div>
</template>
<div class="footer-fixed-box"></div>
<div class="section header-section">
    <div class=" header-container">
        <div class="PM2_logo_wrapper">
            <a class="logo-container link">
                <div class="PM2_logo"></div>
            </a>
        </div>
        <div class="PM2_search search-wrapper">
            <span class="algolia-autocomplete" style="position: relative; display: inline-block; direction: ltr;"><input class="search_input ds-input" placeholder="Search documentation..." autocomplete="off" spellcheck="false" role="combobox" aria-autocomplete="list" aria-expanded="false" aria-owns="algolia-autocomplete-listbox-0" dir="auto" style="position: relative; vertical-align: top;"><pre aria-hidden="true" style="position: absolute; visibility: hidden; white-space: pre; font-family: Blender, sans-serif; font-size: 18px; font-style: normal; font-variant: normal; font-weight: 400; word-spacing: 0px; letter-spacing: normal; text-indent: 0px; text-rendering: auto; text-transform: none;"></pre><span class="ds-dropdown-menu" role="listbox" id="algolia-autocomplete-listbox-0" style="position: absolute; top: 100%; z-index: 100; display: none; left: 0px; right: auto;"><div class="ds-dataset-1"></div></span></span>
            <div class="PM2_search_icon"><i class="fas fa-search"></i></div>
            <div id="hits" class="algolia-results">
                <!-- Hits widget will appear here -->
            </div>
        </div>
    </div>
</div>
<nav class="app-nav no-badge">
    <!--navbar-->
</nav>

    <!-- MAIN-CONTENT AREA -->
    <main>
        <aside class="sidebar">
    <div class="sidebar_2_wrapper">
        <div class="sidebar_2">
            <a href="/runtime/overview" data-page="runtime-page">
                <div class="sidebar_2_item sidebar_2_item_runtime">
                    <img class="sidebar_2_item__image" src="/assets/static/pm2-logo-r.png">
                    <div class="sidebar_2_item__text">Runtime</div>
                </div>
            </a>
            <a href="/monitoring/overview" data-page="monitoring-page">
                <div class="sidebar_2_item sidebar_2_item_monitoring">
                    <img class="sidebar_2_item__image" src="/assets/static/pm2-logo-m.png">
                    <div class="sidebar_2_item__text">Monitoring</div>
                </div>
            </a>
            <a href="/enterprise/overview" data-page="enterprise-page">
                <div class="sidebar_2_item sidebar_2_item_enterprise">
                    <img class="sidebar_2_item__image" src="/assets/static/pm2-logo-e.png">
                    <div class="sidebar_2_item__text">Enterprise</div>
                </div>
            </a>
        <div class="lang-selector">
          <!-- Adds links to other languages on the post -->
          
            
              
                <a href="/runtime/guide/startup-hook/" >Language: English</a>
              

              

              

            
          
            
          
        </div>
        </div>
        <div class="main_content">
        </div>
    </div>
    <div class="sidebar-nav">

    <ul id="acc">
    
    
    
    
    
        <li class="">
            <a href="/ch/runtime/overview/">Overview</a>
            
        </li>
    
    
    
    
        <li class="">
            <a href="/ch/runtime/quick-start/">Quick Start</a>
            
        </li>
    
    
    
    
        <li class="active">
            <a href="/ch/runtime/guide/">Guide</a>
            
                
                    <ul>
                        
                        
                        <li class=""><a href="/ch/runtime/guide/installation/">Installation</a></li>
                        
                        
                        <li class=""><a href="/ch/runtime/guide/ecosystem-file/">Ecosystem File</a></li>
                        
                        
                        <li class=""><a href="/ch/runtime/guide/process-management/">Process Management</a></li>
                        
                        
                        <li class=""><a href="/ch/runtime/guide/log-management/">Log Management</a></li>
                        
                        
                        <li class="active"><a href="/ch/runtime/guide/startup-hook/">Startup Hook</a></li>
                        
                        
                        <li class=""><a href="/ch/runtime/guide/load-balancing/">Load-Balancing (cluster mode)</a></li>
                        
                        
                        <li class=""><a href="/ch/runtime/guide/development-tools/">Development Tools</a></li>
                        
                        
                        <li class=""><a href="/ch/runtime/guide/easy-deploy-with-ssh/">Easy Deploy with SSH</a></li>
                        
                    </ul>
                
            
        </li>
    
    
    
    
        <li class="">
            <a href="/ch/runtime/production-best-practices/">Production Best Practices</a>
            
                
            
        </li>
    
    
    
    
        <li class="">
            <a href="/ch/runtime/integration/">Integration</a>
            
                
            
        </li>
    
    
    
    
        <li class="">
            <a href="/ch/runtime/references/">References</a>
            
                
            
        </li>
    
    </ul>

    </div>
</aside>

        <section class="content">
            <div class="markdown-section gettings_started_block topBlock">
    <p style="display: initial;">Getting started with PM2<span class="runtime_block gettings_started_block_span">Runtime</span><span class="monitoring_block gettings_started_block_span">Monitoring</span><span class="enterprise_block gettings_started_block_span">Enterprise</span></p>
</div>
            <article id="main" class="markdown-section">
                 <h1 id="startup-hook-启动挂钩">Startup Hook 启动挂钩</h1>

<p>The purpose of a startup hook is to save your process list and bring it back at machine restarts, even unexpected ones.
启动挂钩的目的是保存您的进程列表，并在计算机重启甚至出现意外时将其恢复。</p>

<p>Each OS has a specific tool to handle startup hooks: pm2 provides an easy way to generate and configure them.
每个操作系统都有一个特定的工具来处理启动挂钩：pm2提供了一种简单的方法来生成和配置它们。</p>

<hr />

<h2 id="installation-安装">Installation 安装</h2>

<p>To detect available init systems on your machine and generate a configuration, use:
检测计算机上可用的init系统并生成配置，使用：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pm2 startup
<span class="nv">$ </span><span class="o">[</span>PM2] You have to run this <span class="nb">command </span>as root. Execute the following <span class="nb">command</span>:
<span class="nv">$ </span><span class="nb">sudo </span>su <span class="nt">-c</span> <span class="s2">"env PATH=</span><span class="nv">$PATH</span><span class="s2">:/home/unitech/.nvm/versions/node/v4.3/bin pm2 startup &lt;distribution&gt; -u &lt;user&gt; --hp &lt;home-path&gt;
</span></code></pre></div></div>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pm2 启动
<span class="nv">$ </span><span class="o">[</span>PM2] 您必须以root身份运行此命令。 执行以下命令:
<span class="nv">$ </span><span class="nb">sudo </span>su <span class="nt">-c</span> <span class="s2">"env PATH=</span><span class="nv">$PATH</span><span class="s2">:/home/unitech/.nvm/versions/node/v4.3/bin pm2 startup &lt;distribution&gt; -u &lt;user&gt; --hp &lt;home-path&gt;
</span></code></pre></div></div>

<p>Copy and paste in the CLI the ouput of this command to set up your startup hook.
在CLI中复制并粘贴此命令的输出以设置启动挂钩。</p>

<p>!&gt; With NVM, the <code class="highlighter-rouge">pm2</code> path change when updating nodejs. You need to run the <code class="highlighter-rouge">startup</code> command after every update.
使用NVM时，此<code class="highlighter-rouge">pm2</code>路径会在更新nodejs时改变。 每次更新后您都需要运行<code class="highlighter-rouge">startup</code>命令。</p>

<p>?&gt; You can customize the service name via the <code class="highlighter-rouge">--service-name &lt;name&gt;</code> option (<a href="https://github.com/Unitech/pm2/pull/3213">#3213</a>)
您可以通过<code class="highlighter-rouge">--service-name &lt;name&gt;</code>选项自定义服务名称 (<a href="https://github.com/Unitech/pm2/pull/3213">#3213</a>)</p>

<hr />

<h2 id="save-your-process-list-保存您的进程列表">Save your process list 保存您的进程列表</h2>

<p>The startup hook auto load the process list that you have previously saved.
启动挂钩会自动加载您之前保存的进程列表。</p>

<p>Save your process list with:
以此来保存您的进程列表：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pm2 save
</code></pre></div></div>

<hr />

<h2 id="disabling-startup-system-禁用启动系统">Disabling startup system 禁用启动系统</h2>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pm2 unstartup
</code></pre></div></div>

<hr />

<h2 id="user-permissions-用户权限">User permissions 用户权限</h2>

<p>If you want the startup hook to be executed under another user, use the <code class="highlighter-rouge">-u &lt;username&gt;</code> option and the <code class="highlighter-rouge">--hp &lt;user_home&gt;</code>:
如果您希望启动挂钩在其他用户下执行，使用 <code class="highlighter-rouge">-u &lt;username&gt;</code>和 <code class="highlighter-rouge">--hp &lt;user_home&gt;</code>选项：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pm2 startup ubuntu <span class="nt">-u</span> www <span class="nt">--hp</span> /home/ubuntu
</code></pre></div></div>

<hr />

<h2 id="update-startup-hook-更新启动挂钩">Update startup hook 更新启动挂钩</h2>

<p>To update the startup hook run the following commands:
要更新启动挂钩，请运行以下命令：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pm2 unstartup
pm2 startup
</code></pre></div></div>

<hr />

<h2 id="compatibility-兼容性">Compatibility 兼容性</h2>

<p>Init systems supported are:
支持的Init系统是：</p>

<ul>
  <li><strong>systemd</strong>: Ubuntu &gt;= 16, CentOS &gt;= 7, Arch, Debian &gt;= 7</li>
  <li><strong>upstart</strong>: Ubuntu &lt;= 14</li>
  <li><strong>launchd</strong>: Darwin, MacOSx</li>
  <li><strong>openrc</strong>: Gentoo Linux, Arch Linux</li>
  <li><strong>rcd</strong>: FreeBSD</li>
  <li><strong>systemv</strong>: Centos 6, Amazon Linux</li>
</ul>

<p>You can specify the platform you use if you want to:
如果您愿意，您可以指定使用平台：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pm2 <span class="o">[</span>startup | unstartup] <span class="o">[</span>platform]
</code></pre></div></div>

<p>Platform can be either one of the cited below:
平台可以是下列的其中一个：</p>

<p><code class="highlighter-rouge">[ubuntu | ubuntu14 | ubuntu12 | centos | centos6 | arch | oracle | amazon | macos | darwin | freebsd | systemd | systemv | upstart | launchd | rcd | openrc]</code></p>

<hr />

<h2 id="under-the-hood-在后台">Under the hood 在后台</h2>

<ul>
  <li><strong>ubuntu</strong> use <code class="highlighter-rouge">updaterc.d</code> and the script <code class="highlighter-rouge">lib/scripts/pm2-init.sh</code></li>
  <li><strong>centos</strong>/<strong>redhat</strong> use <code class="highlighter-rouge">chkconfig</code> and the script <code class="highlighter-rouge">lib/scripts/pm2-init-centos.sh</code></li>
  <li><strong>gentoo</strong> use <code class="highlighter-rouge">rc-update</code> and the script <code class="highlighter-rouge">lib/scripts/pm2</code></li>
  <li><strong>systemd</strong> use <code class="highlighter-rouge">systemctl</code> and the script <code class="highlighter-rouge">lib/scripts/pm2.service</code></li>
  <li><strong>darwin</strong> use <code class="highlighter-rouge">launchd</code> to load a specific <code class="highlighter-rouge">plist</code> to resurrect processes after reboot.</li>
  <li><strong>ubuntu</strong> 使用 <code class="highlighter-rouge">updaterc.d</code> 和脚本 <code class="highlighter-rouge">lib/scripts/pm2-init.sh</code></li>
  <li><strong>centos</strong>/<strong>redhat</strong> use <code class="highlighter-rouge">chkconfig</code> 和脚本 <code class="highlighter-rouge">lib/scripts/pm2-init-centos.sh</code></li>
  <li><strong>gentoo</strong> 使用 <code class="highlighter-rouge">rc-update</code> 和脚本 <code class="highlighter-rouge">lib/scripts/pm2</code></li>
  <li><strong>systemd</strong> 使用 <code class="highlighter-rouge">systemctl</code> 和脚本 <code class="highlighter-rouge">lib/scripts/pm2.service</code></li>
  <li><strong>darwin</strong> 使用 <code class="highlighter-rouge">launchd</code> 来加载一个特定的 <code class="highlighter-rouge">plist</code> 以便在重启后复活进程.</li>
</ul>

<hr />

<h2 id="windows-consideration-关于windows">Windows consideration 关于windows</h2>

<p>There are some external libraries to generate a Windows compatible startup script, please checkout <a href="https://www.npmjs.com/package/pm2-windows-service">pm2-windows-service</a> or <a href="https://www.npmjs.com/package/pm2-windows-startup">pm2-windows-startup</a>.
有一些外部库可以生成一个与Windows兼容的启动脚本，请查看<a href="https://www.npmjs.com/package/pm2-windows-service">pm2-windows-service</a> 或 <a href="https://www.npmjs.com/package/pm2-windows-startup">pm2-windows-startup</a>.</p>

<hr />

<h2 id="next-step-下一步">Next step 下一步</h2>

<p><a href="runtime/guide/cluster.md">Load-balancing (cluster mode)</a>
<a href="runtime/guide/cluster.md">负载平衡 (群集模式)</a></p>

<hr />

<h2 id="questions--问题">Questions ? 问题？</h2>

<p>We are always happy to help with questions you might have. Search our documentation or check out answers to common questions. You can also post questions or comments to our community forum.
我们永远乐于帮您解决可能遇到的问题。搜索我们的文档或查看常见问题的答案。您也可以在我们的社区论坛发布问题或评论。</p>


            </article>

        <article class="markdown-section copyright">
    <p>© 2018 Keymetrics</p>
    <ul id="footer">
        <li><a href="javascript:void(0);">Terms of Use</a></li>
        <li><a href="javascript:void(0);">Privacy Policy</a></li>

        <!-- Adds links to other languages on the post -->
        
          
            
              <li><p class="footer-list">Language: <a href="/runtime/guide/startup-hook/" >English</a></p></li>
            

            

            

          
        
          
        
    </ul>
</article>

        </section>

    </main>
</body>
    <script>window.$docsify = {"basePath":"/docs","alias":{"/runtime/.*/_sidebar.md":"/runtime/_sidebar.md","/monitoring/.*/_sidebar.md":"/monitoring/_sidebar.md","/enterprise/.*/_sidebar.md":"/enterprise/_sidebar.md"},"auto2top":true,"coverpage":false,"executeScript":true,"loadSidebar":"_sidebar.md","loadNavbar":false,"mergeNavbar":false,"subMaxLevel":1,"name":"","search":false,"plugins":[],"routerMode":"history"}</script>
<!-- <script src="//unpkg.com/docsify/lib/docsify.min.js"></script> -->
<!-- <script src="/ch/assets/js/docsify.js"></script> -->
<script src="/assets/js/scripts.js" type="text/javascript"></script>
<script src="https://unpkg.com/clipboard@2.0.0/dist/clipboard.min.js" type="text/javascript"></script>
<script src="https://unpkg.com/prismjs@1.13.0/prism.js" type="text/javascript"></script>
<script src="https://unpkg.com/prismjs/components/prism-bash.min.js" type="text/javascript"></script>
<script src="https://unpkg.com/prismjs/components/prism-markdown.min.js" type="text/javascript"></script>
<script src="https://unpkg.com/prismjs/components/prism-nginx.min.js" type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/blueimp-md5/2.10.0/js/md5.min.js" type="text/javascript"></script>
<script src="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.js" type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="/assets/js/prism-clipboard.js" type="text/javascript"></script>
<!-- <script src="https://unpkg.com/gitalk@latest/dist/gitalk.min.js"></script> -->
<!-- <script src="/ch/assets/js/gittalk.js"></script> -->
<script src="/assets/js/keymetrics-plugins.js" type="text/javascript"></script>
<script src="/assets/js/additional.js" type="text/javascript"></script>
</html>
